<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Community | CodeMaster</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            box-sizing: border-box;
            background-color: #f0f4f8;
        }
        .progress-bar {
            transition: width 0.5s ease-in-out;
        }
        .card-hover {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .online-indicator {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
        /* NEW NAV STYLES for consistency */
        .nav-link {
            padding: 0.25rem 0.5rem;
            color: #4b5563; /* Gray-600 */
            transition: color 0.2s, border-color 0.2s;
            border-bottom: 2px solid transparent;
            font-weight: 500;
        }
        .nav-link:hover {
            color: #1f2937; /* Gray-800 */
            border-bottom-color: #6366f1; /* Indigo-500 */
        }
        .nav-link.active {
            color: #3b82f6; /* Blue-600 */
            border-bottom-color: #3b82f6;
            font-weight: 600;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans">
    <header class="bg-white shadow-sm border-b sticky top-0 z-20">
        <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
            <div class="flex items-center space-x-6">
                <a href="index.html" class="flex-shrink-0 flex items-center">
                    <div class="text-2xl font-bold text-indigo-600">CodeMaster</div>
                </a>
                <nav class="hidden sm:flex space-x-4 lg:space-x-8 h-full items-center">
                    <a href="CourseandLesson.html" class="nav-link">Courses</a>
                    <a href="AccountProfile.html" class="nav-link">My Learning</a>
                    <a href="QuizzAndGrades.html" class="nav-link">Quizz</a>
                    <a href="Community.html" class="nav-link active">Community</a>
                </nav>
            </div>
            
            <div class="flex items-center space-x-4">
                <div class="relative hidden sm:block">
                    <input type="text" placeholder="Search friends or groups..." class="pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <span class="absolute left-3 top-2.5 text-gray-400">üîç</span>
                </div>
                <div id="user-profile-btn" class="flex items-center cursor-pointer space-x-2">
                    <div id="user-avatar" class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold">
                        AC
                    </div>
                    <span id="user-name" class="text-sm font-medium hidden sm:block">Alex Chen</span>
                    <div class="w-3 h-3 bg-green-400 rounded-full online-indicator"></div>
                </div>
                <button id="logout-button" class="text-sm font-medium text-gray-500 hover:text-gray-800 hidden sm:block">Logout</button>
            </div>
        </div>
    </header>

    <div class="max-w-7xl mx-auto px-4 py-6">
        <div class="grid lg:grid-cols-4 gap-6">
            <div class="lg:col-span-1 space-y-6">
                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <h3 class="text-lg font-bold mb-4 text-gray-800">My Progress Today</h3>
                    <div class="space-y-4">
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span>Study Time</span>
                                <span class="font-semibold">3.5h / 5h</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-blue-500 h-2 rounded-full progress-bar" style="width: 70%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span>Courses Completed</span>
                                <span class="font-semibold">2 / 3</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-green-500 h-2 rounded-full progress-bar" style="width: 67%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span>Weekly Goal</span>
                                <span class="font-semibold">18h / 25h</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-purple-500 h-2 rounded-full progress-bar" style="width: 72%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-4 p-3 bg-blue-50 rounded-lg">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-blue-600">1,247</div>
                            <div class="text-sm text-gray-600">Study Points</div>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <h3 class="text-lg font-bold mb-4 text-gray-800">Quick Actions</h3>
                    <div class="space-y-3">
                        <button class="w-full bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors">
                            Start Study Session
                        </button>
                        <button class="w-full bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 transition-colors">
                            Create Study Group
                        </button>
                        <button class="w-full border border-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-50 transition-colors">
                            Find Study Buddy
                        </button>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-2 space-y-6">
                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold text-gray-800">üèÜ Weekly Leaderboard</h3>
                        <select class="border rounded-lg px-3 py-1 text-sm">
                            <option>This Week</option>
                            <option>This Month</option>
                            <option>All Time</option>
                        </select>
                    </div>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg border border-yellow-200">
                            <div class="flex items-center space-x-3">
                                <div class="text-2xl">ü•á</div>
                                <div class="w-10 h-10 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full flex items-center justify-center text-white font-bold">
                                    SM
                                </div>
                                <div>
                                    <div class="font-semibold">Sarah Martinez</div>
                                    <div class="text-sm text-gray-600">32 hours studied</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-orange-600">2,840 pts</div>
                                <div class="text-xs text-gray-500">+340 this week</div>
                            </div>
                        </div>

                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div class="flex items-center space-x-3">
                                <div class="text-2xl">ü•à</div>
                                <div class="w-10 h-10 bg-gradient-to-r from-gray-400 to-gray-600 rounded-full flex items-center justify-center text-white font-bold">
                                    DK
                                </div>
                                <div>
                                    <div class="font-semibold">David Kim</div>
                                    <div class="text-sm text-gray-600">28 hours studied</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-gray-600">2,520 pts</div>
                                <div class="text-xs text-gray-500">+280 this week</div>
                            </div>
                        </div>

                        <div id="user-leaderboard-entry" class="flex items-center justify-between p-3 bg-orange-50 rounded-lg">
                            <div class="flex items-center space-x-3">
                                <div class="text-2xl">ü•â</div>
                                <div class="w-10 h-10 bg-gradient-to-r from-orange-400 to-red-500 rounded-full flex items-center justify-center text-white font-bold">
                                    AC
                                </div>
                                <div>
                                    <div class="font-semibold">Alex Chen (You)</div>
                                    <div class="text-sm text-gray-600">25 hours studied</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-orange-600">2,247 pts</div>
                                <div class="text-xs text-gray-500">+247 this week</div>
                            </div>
                        </div>

                        <div class="flex items-center justify-between p-3 rounded-lg">
                            <div class="flex items-center space-x-3">
                                <div class="text-lg text-gray-400">4</div>
                                <div class="w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center text-white font-bold">
                                    EJ
                                </div>
                                <div>
                                    <div class="font-semibold">Emma Johnson</div>
                                    <div class="text-sm text-gray-600">22 hours studied</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-gray-700">1,980 pts</div>
                                <div class="text-xs text-gray-500">+180 this week</div>
                            </div>
                        </div>

                        <div class="flex items-center justify-between p-3 rounded-lg">
                            <div class="flex items-center space-x-3">
                                <div class="text-lg text-gray-400">5</div>
                                <div class="w-10 h-10 bg-green-500 rounded-full flex items-center justify-center text-white font-bold">
                                    MR
                                </div>
                                <div>
                                    <div class="font-semibold">Mike Rodriguez</div>
                                    <div class="text-sm text-gray-600">20 hours studied</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-gray-700">1,750 pts</div>
                                <div class="text-xs text-gray-500">+150 this week</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold text-gray-800">üìö My Study Groups</h3>
                        <button class="bg-blue-500 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-600 transition-colors">
                            Join New Group
                        </button>
                    </div>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="border rounded-lg p-4 card-hover">
                            <div class="flex items-center justify-between mb-3">
                                <h4 class="font-semibold text-gray-800">JavaScript Masters</h4>
                                <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">Active</span>
                            </div>
                            <div class="flex items-center space-x-2 mb-3">
                                <div class="flex -space-x-2">
                                    <div class="w-6 h-6 bg-blue-500 rounded-full border-2 border-white"></div>
                                    <div class="w-6 h-6 bg-green-500 rounded-full border-2 border-white"></div>
                                    <div class="w-6 h-6 bg-purple-500 rounded-full border-2 border-white"></div>
                                    <div class="w-6 h-6 bg-gray-400 rounded-full border-2 border-white flex items-center justify-center text-xs text-white">+5</div>
                                </div>
                                <span class="text-sm text-gray-600">8 members</span>
                            </div>
                            <div class="text-sm text-gray-600 mb-3">Next session: Today 7:00 PM</div>
                            <div class="flex space-x-2">
                                <button class="flex-1 bg-blue-500 text-white py-2 px-3 rounded text-sm hover:bg-blue-600 transition-colors">
                                    Join Session
                                </button>
                                <button class="px-3 py-2 border rounded text-sm hover:bg-gray-50 transition-colors">
                                    üí¨
                                </button>
                            </div>
                        </div>

                        <div class="border rounded-lg p-4 card-hover">
                            <div class="flex items-center justify-between mb-3">
                                <h4 class="font-semibold text-gray-800">Data Science Squad</h4>
                                <span class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs">Studying</span>
                            </div>
                            <div class="flex items-center space-x-2 mb-3">
                                <div class="flex -space-x-2">
                                    <div class="w-6 h-6 bg-red-500 rounded-full border-2 border-white"></div>
                                    <div class="w-6 h-6 bg-yellow-500 rounded-full border-2 border-white"></div>
                                    <div class="w-6 h-6 bg-indigo-500 rounded-full border-2 border-white"></div>
                                </div>
                                <span class="text-sm text-gray-600">6 members</span>
                            </div>
                            <div class="text-sm text-gray-600 mb-3">Next session: Tomorrow 2:00 PM</div>
                            <div class="flex space-x-2">
                                <button class="flex-1 bg-green-500 text-white py-2 px-3 rounded text-sm hover:bg-green-600 transition-colors">
                                    View Progress
                                </button>
                                <button class="px-3 py-2 border rounded text-sm hover:bg-gray-50 transition-colors">
                                    üí¨
                                </button>
                            </div>
                        </div>

                        <div class="border rounded-lg p-4 card-hover">
                            <div class="flex items-center justify-between mb-3">
                                <h4 class="font-semibold text-gray-800">UI/UX Designers</h4>
                                <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded-full text-xs">Planning</span>
                            </div>
                            <div class="flex items-center space-x-2 mb-3">
                                <div class="flex -space-x-2">
                                    <div class="w-6 h-6 bg-pink-500 rounded-full border-2 border-white"></div>
                                    <div class="w-6 h-6 bg-teal-500 rounded-full border-2 border-white"></div>
                                    <div class="w-6 h-6 bg-orange-500 rounded-full border-2 border-white"></div>
                                    <div class="w-6 h-6 bg-gray-400 rounded-full border-2 border-white flex items-center justify-center text-xs text-white">+2</div>
                                </div>
                                <span class="text-sm text-gray-600">5 members</span>
                            </div>
                            <div class="text-sm text-gray-600 mb-3">Next session: Dec 16, 6:00 PM</div>
                            <div class="flex space-x-2">
                                <button class="flex-1 bg-purple-500 text-white py-2 px-3 rounded text-sm hover:bg-purple-600 transition-colors">
                                    Join Planning
                                </button>
                                <button class="px-3 py-2 border rounded text-sm hover:bg-gray-50 transition-colors">
                                    üí¨
                                </button>
                            </div>
                        </div>

                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 flex items-center justify-center">
                            <button class="text-gray-500 hover:text-gray-700 transition-colors">
                                <div class="text-3xl mb-2">‚ûï</div>
                                <div class="text-sm">Create New Group</div>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <h3 class="text-xl font-bold mb-6 text-gray-800">üìà Recent Activity</h3>
                    <div class="space-y-4">
                        <div class="flex items-start space-x-3 p-3 bg-blue-50 rounded-lg">
                            <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold text-sm">
                                SM
                            </div>
                            <div class="flex-1">
                                <div class="text-sm">
                                    <span class="font-semibold">Sarah Martinez</span> completed 
                                    <span class="font-medium text-blue-600">Advanced React Patterns</span>
                                </div>
                                <div class="text-xs text-gray-500 mt-1">2 hours ago ‚Ä¢ +150 points</div>
                            </div>
                        </div>

                        <div class="flex items-start space-x-3 p-3 bg-green-50 rounded-lg">
                            <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center text-white font-semibold text-sm">
                                DK
                            </div>
                            <div class="flex-1">
                                <div class="text-sm">
                                    <span class="font-semibold">David Kim</span> started a new study streak! 
                                    <span class="font-medium text-green-600">7 days in a row</span>
                                </div>
                                <div class="text-xs text-gray-500 mt-1">4 hours ago ‚Ä¢ +200 bonus points</div>
                            </div>
                        </div>

                        <div class="flex items-start space-x-3 p-3 bg-purple-50 rounded-lg">
                            <div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center text-white font-semibold text-sm">
                                EJ
                            </div>
                            <div class="flex-1">
                                <div class="text-sm">
                                    <span class="font-semibold">Emma Johnson</span> created a new study group 
                                    <span class="font-medium text-purple-600">"Mobile App Design"</span>
                                </div>
                                <div class="text-xs text-gray-500 mt-1">6 hours ago</div>
                            </div>
                        </div>

                        <div class="flex items-start space-x-3 p-3 bg-orange-50 rounded-lg">
                            <div class="w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center text-white font-semibold text-sm">
                                AC
                            </div>
                            <div class="flex-1">
                                <div class="text-sm">
                                    <span class="font-semibold">You</span> joined the study group 
                                    <span class="font-medium text-orange-600">"JavaScript Masters"</span>
                                </div>
                                <div class="text-xs text-gray-500 mt-1">Yesterday</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-1 space-y-6">
                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-bold text-gray-800">üë• Friends Online</h3>
                        <span class="text-sm text-gray-500">12 online</span>
                    </div>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="relative">
                                    <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold text-sm">
                                        SM
                                    </div>
                                    <div class="absolute -bottom-1 -right-1 w-3 h-3 bg-green-400 rounded-full border-2 border-white online-indicator"></div>
                                </div>
                                <div>
                                    <div class="text-sm font-semibold">Sarah Martinez</div>
                                    <div class="text-xs text-gray-500">Studying React</div>
                                </div>
                            </div>
                            <button class="text-blue-500 hover:text-blue-600 text-sm">
                                üí¨
                            </button>
                        </div>

                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="relative">
                                    <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center text-white font-semibold text-sm">
                                        DK
                                    </div>
                                    <div class="absolute -bottom-1 -right-1 w-3 h-3 bg-green-400 rounded-full border-2 border-white online-indicator"></div>
                                </div>
                                <div>
                                    <div class="text-sm font-semibold">David Kim</div>
                                    <div class="text-xs text-gray-500">In study session</div>
                                </div>
                            </div>
                            <button class="text-green-500 hover:text-green-600 text-sm">
                                üéØ
                            </button>
                        </div>

                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="relative">
                                    <div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center text-white font-semibold text-sm">
                                        EJ
                                    </div>
                                    <div class="absolute -bottom-1 -right-1 w-3 h-3 bg-green-400 rounded-full border-2 border-white online-indicator"></div>
                                </div>
                                <div>
                                    <div class="text-sm font-semibold">Emma Johnson</div>
                                    <div class="text-xs text-gray-500">Available</div>
                                </div>
                            </div>
                            <button class="text-purple-500 hover:text-purple-600 text-sm">
                                üëã
                            </button>
                        </div>

                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="relative">
                                    <div class="w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center text-white font-semibold text-sm">
                                        MR
                                    </div>
                                    <div class="absolute -bottom-1 -right-1 w-3 h-3 bg-yellow-400 rounded-full border-2 border-white"></div>
                                </div>
                                <div>
                                    <div class="text-sm font-semibold">Mike Rodriguez</div>
                                    <div class="text-xs text-gray-500">Away</div>
                                </div>
                            </div>
                            <button class="text-gray-400 text-sm">
                                üí§
                            </button>
                        </div>
                    </div>
                    <button class="w-full mt-4 text-blue-500 hover:text-blue-600 text-sm font-medium">
                        View All Friends
                    </button>
                </div>

                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <h3 class="text-lg font-bold mb-4 text-gray-800">üéØ Active Challenges</h3>
                    <div class="space-y-4">
                        <div class="border border-blue-200 rounded-lg p-4 bg-blue-50">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-semibold text-blue-800">7-Day Streak</h4>
                                <span class="text-xs bg-blue-200 text-blue-800 px-2 py-1 rounded-full">5/7 days</span>
                            </div>
                            <div class="w-full bg-blue-200 rounded-full h-2 mb-2">
                                <div class="bg-blue-500 h-2 rounded-full progress-bar" style="width: 71%"></div>
                            </div>
                            <div class="text-xs text-blue-700">Study for 7 consecutive days</div>
                        </div>

                        <div class="border border-green-200 rounded-lg p-4 bg-green-50">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-semibold text-green-800">Course Marathon</h4>
                                <span class="text-xs bg-green-200 text-green-800 px-2 py-1 rounded-full">2/5 courses</span>
                            </div>
                            <div class="w-full bg-green-200 rounded-full h-2 mb-2">
                                <div class="bg-green-500 h-2 rounded-full progress-bar" style="width: 40%"></div>
                            </div>
                            <div class="text-xs text-green-700">Complete 5 courses this month</div>
                        </div>

                        <div class="border border-purple-200 rounded-lg p-4 bg-purple-50">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-semibold text-purple-800">Group Leader</h4>
                                <span class="text-xs bg-purple-200 text-purple-800 px-2 py-1 rounded-full">New!</span>
                            </div>
                            <div class="text-xs text-purple-700">Host 3 successful study sessions</div>
                            <button class="mt-2 text-xs bg-purple-500 text-white px-3 py-1 rounded-full hover:bg-purple-600 transition-colors">
                                Start Challenge
                            </button>
                        </div>
                    </div>
                    <button class="w-full mt-4 text-blue-500 hover:text-blue-600 text-sm font-medium">
                        See More Suggestions
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // L·∫•y th√¥ng tin ng∆∞·ªùi d√πng t·ª´ Local Storage
        function getUserDetails() {
            // T·∫°m th·ªùi tr·∫£ v·ªÅ d·ªØ li·ªáu gi·∫£ ƒë·ªãnh n·∫øu kh√¥ng c√≥ trong localStorage cho demo Community Page
            const storedUser = localStorage.getItem('user');
            if (storedUser) return JSON.parse(storedUser);
            // Fallback cho demo
            return { name: "Alex Chen", email: "alex@codemaster.com", role: "student" }; 
        }

        function getUserInitials() {
            const user = getUserDetails();
            if (user && user.name) {
                const parts = user.name.split(' ');
                let initials = parts[0].charAt(0).toUpperCase();
                if (parts.length > 1) {
                    initials += parts.pop().charAt(0).toUpperCase();
                }
                return initials;
            }
            return 'AC';
        }

        // Setup listeners for navigation and actions
        function setupListeners() {
            const user = getUserDetails();
            const initials = getUserInitials();

            // Update user info in header
            const userAvatarDiv = document.getElementById('user-avatar');
            const userNameSpan = document.getElementById('user-name');
            if (userAvatarDiv) userAvatarDiv.textContent = initials;
            if (userNameSpan) userNameSpan.textContent = user.name;
            
            // Logout functionality
            const logoutButton = document.getElementById('logout-button');
            if (logoutButton) {
                logoutButton.addEventListener('click', () => {
                    localStorage.clear();
                    window.location.href = 'LoginPage.html';
                });
            }

            // Redirect user profile click (Header avatar)
            const userProfileBtn = document.getElementById('user-profile-btn');
            if (userProfileBtn) {
                userProfileBtn.addEventListener('click', () => {
                    const role = user ? user.role : 'student';
                    if (role === 'student') window.location.href = 'AccountProfile.html';
                    if (role === 'teacher' || role === 'admin') window.location.href = 'AdminDashboard.html';
                });
            }
        }
        
        // Simulate real-time updates
        function updateProgress() {
            const progressBars = document.querySelectorAll('.progress-bar');
            progressBars.forEach(bar => {
                const currentWidth = parseInt(bar.style.width);
                if (Math.random() > 0.7) { // 30% chance to update
                    const newWidth = Math.min(currentWidth + Math.floor(Math.random() * 5), 100);
                    bar.style.width = newWidth + '%';
                }
            });
        }

        // Simulate study points increasing
        function updateStudyPoints() {
            const pointsElement = document.querySelector('.text-2xl.font-bold.text-blue-600');
            if (pointsElement) {
                let currentPoints = parseInt(pointsElement.textContent.replace(/,/g, ''));
                if (Math.random() > 0.8) { // 20% chance to get points
                    const earned = Math.floor(Math.random() * 10) + 1;
                    currentPoints += earned;
                    pointsElement.textContent = currentPoints.toLocaleString();
                    
                    // Show points notification
                    const notification = document.createElement('div');
                    notification.className = 'fixed top-20 right-4 bg-yellow-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300';
                    notification.textContent = `+${earned} study points earned!`;
                    document.body.appendChild(notification);
                    
                    setTimeout(() => {
                        notification.classList.remove('translate-x-full');
                    }, 100);
                    
                    setTimeout(() => {
                        notification.classList.add('translate-x-full');
                        setTimeout(() => {
                            if (document.body.contains(notification)) {
                                document.body.removeChild(notification);
                            }
                        }, 300);
                    }, 2000);
                }
            }
        }

        // Add click handlers for all buttons
        document.addEventListener('DOMContentLoaded', () => {
            setupListeners();
            
            // Bind general button actions
            document.querySelectorAll('button').forEach(button => {
                // Ensure default click handlers for logout/profile are not overwritten
                if (button.parentElement.id !== 'user-profile-btn' && button.id !== 'logout-button' ) {
                    button.addEventListener('click', function(e) {
                        e.preventDefault();
                        const buttonText = this.textContent.trim();
                        
                        const notification = document.createElement('div');
                        notification.className = 'fixed top-4 right-4 bg-blue-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300';
                        
                        if (buttonText.includes('Study Session')) {
                            notification.textContent = '‚è±Ô∏è Study session started! Timer is running.';
                            notification.className = notification.className.replace('bg-blue-500', 'bg-green-500');
                        } else if (buttonText.includes('Connect')) {
                            notification.textContent = 'ü§ù Friend request sent!';
                        } else if (buttonText.includes('Join')) {
                            notification.textContent = '‚úÖ Successfully joined!';
                        } else if (buttonText.includes('Create')) {
                            notification.textContent = 'üéâ New study group created!';
                        } else {
                            // Don't show notifications for emoji buttons or other non-action buttons
                            if (buttonText.length > 2) {
                                notification.textContent = `${buttonText} - Feature activated!`;
                            } else {
                                return; // Do not show notification for small/emoji buttons
                            }
                        }
                        
                        document.body.appendChild(notification);
                        
                        setTimeout(() => {
                            notification.classList.remove('translate-x-full');
                        }, 100);
                        
                        setTimeout(() => {
                            notification.classList.add('translate-x-full');
                            setTimeout(() => {
                                if (document.body.contains(notification)) {
                                    document.body.removeChild(notification);
                                }
                            }, 300);
                        }, 3000);
                    });
                }
            });
        });

        // Update progress bars every 10 seconds
        setInterval(updateProgress, 10000);
        
        // Update study points every 15 seconds
        setInterval(updateStudyPoints, 15000);
    </script>
</body>
</html>