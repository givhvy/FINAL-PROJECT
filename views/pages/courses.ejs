<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Courses | UniLearn</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path fill='%233B82F6' d='M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5'></path></svg>">
    <style>
        body { font-family: 'Poppins', sans-serif; background-color: #f8fafc; }
        .course-card { min-height: 380px; }
        .course-card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); }
        .lesson-card:hover { background-color: #f0f9ff; }
        .active-lesson { border-left: 4px solid #3b82f6; background-color: #eff6ff; font-weight: 600; }
        
        /* Enhanced Loading Spinner */
        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1rem;
        }
        .loader { 
            border: 5px solid #e5e7eb; 
            border-radius: 50%; 
            border-top: 5px solid #3b82f6; 
            border-right: 5px solid #3b82f6;
            width: 60px; 
            height: 60px; 
            animation: spin 0.8s linear infinite; 
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .loading-text {
            color: #6b7280;
            font-size: 1rem;
            font-weight: 500;
            animation: pulse 1.5s ease-in-out infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
        
        /* Progress Bar Styles for Cards */
        .progress-bar-container { height: 6px; border-radius: 3px; background-color: #e5e7eb; overflow: hidden; }
        .progress-fill-blue { background-color: #3b82f6; }
        .progress-fill-purple { background-color: #3b82f6; }
        .progress-fill-red { background-color: #ef4444; }
        .progress-fill-green { background-color: #10b981; }
        .progress-fill-yellow { background-color: #f59e0b; }
        .progress-fill-gray { background-color: #9ca3af; }
        
        /* CSS for 2-line description ellipsis */
        .two-line-ellipsis {
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            white-space: normal;
            min-height: 2.5rem;
        }

        /* BANNER CAROUSEL STYLES - Enhanced */
        .featured-banner {
            height: 300px;
            background-size: cover;
            background-position: center;
            position: relative;
            display: flex;
            align-items: center;
            padding: 2rem 3rem;
            overflow: hidden;
            transition: background-image 1s ease-in-out;
        }
        .featured-banner::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(90deg, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.1) 100%);
            z-index: 1;
        }
        .banner-content { 
            z-index: 2; color: white; max-width: 600px; 
            animation: fadeIn 1s ease-in-out;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* CAROUSEL PAGINATION DOTS */
        .carousel-pagination {
            position: absolute;
            bottom: 1.5rem;
            left: 50%;
            transform: translateX(-50%);
            z-index: 3;
            display: flex;
            gap: 0.5rem;
        }
        .pagination-dot {
            width: 12px; height: 12px;
            background-color: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .pagination-dot:hover { background-color: rgba(255, 255, 255, 0.8); }
        .pagination-dot.active {
            background-color: white;
            transform: scale(1.2);
        }

        /* FILTER & NAV STYLES */
        .filter-btn { padding: 0.5rem 1rem; border-radius: 9999px; transition: all 0.2s; cursor: pointer; font-weight: 500; color: #4b5563; background-color: #f3f4f6; }
        .filter-btn:hover:not(.active) { background-color: #e5e7eb; }
        .filter-btn.active { background-color: #2563eb; color: white; box-shadow: 0 4px 6px -1px rgba(79, 70, 229, 0.3); }
        
        .category-gallery-item { aspect-ratio: 16/9; background-size: cover; background-position: center; position: relative; cursor: pointer; transition: transform 0.3s ease; }
        .category-gallery-item:hover { transform: translateY(-4px); box-shadow: 0 10px 20px rgba(0,0,0,0.15); }

        .nav-link { padding: 0.25rem 0.5rem; color: #4b5563; transition: color 0.2s, border-color 0.2s; border-bottom: 2px solid transparent; font-weight: 500; }
        .nav-link:hover { color: #1f2937; border-bottom-color: #3b82f6; }
        .nav-link.active { color: #3b82f6; border-bottom-color: #3b82f6; }
        /* Custom Logo Style */
        .header-logo { color: #2563eb; font-weight: 800; }

        /* Mobile Menu Styles */
        .mobile-menu { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .mobile-menu.active { max-height: 500px; }

        /* Progress indicator animation */
        .progress-indicator {
            background: linear-gradient(90deg, #3b82f6, #3b82f6, #ef4444, #10b981);
            background-size: 400% 400%;
            animation: gradientShift 3s ease infinite;
        }
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* MOBILE RESPONSIVE STYLES */
        @media (max-width: 640px) {
            .featured-banner {
                height: 180px; /* Shorter banner on mobile */
                padding: 1rem;
                border-radius: 0.75rem; /* Smaller border radius */
            }
            .banner-content {
                max-width: 100%;
            }
            .banner-content h1 {
                font-size: 1.25rem !important; /* Smaller title */
                line-height: 1.3;
                margin-bottom: 0.5rem;
            }
            .banner-content .text-sm {
                font-size: 0.75rem !important; /* Smaller tag */
                padding: 0.25rem 0.5rem;
            }
            .banner-content p {
                font-size: 0.75rem !important; /* Smaller description */
                line-height: 1.4;
                display: -webkit-box;
                -webkit-line-clamp: 2; /* Limit to 2 lines */
                -webkit-box-orient: vertical;
                overflow: hidden;
            }
            .banner-content button {
                font-size: 0.75rem;
                padding: 0.5rem 1rem;
                margin-top: 0.75rem;
            }
            .carousel-pagination {
                bottom: 0.75rem;
            }
            .pagination-dot {
                width: 8px;
                height: 8px;
            }
            .filter-btn {
                font-size: 0.875rem;
                padding: 0.375rem 0.75rem;
            }
            .course-card {
                min-height: auto;
            }
        }

        /* Line clamp utility for course titles */
        .line-clamp-2 {
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
        }
    </style>
    <script src="/js/darkmode.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class'
        }
    </script>
    <link rel="stylesheet" href="/css/darkmode-improved.css">
</head>
<body class="transition-colors duration-300 bg-gray-50 dark:bg-gray-900">
    <%- include('../partials/header') %>

    <div id="app">
        <div id="courses-page" class="courses-container max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">            
            <div id="featured-banner" class="featured-banner rounded-xl shadow-2xl mb-10">
                <div id="banner-content" class="banner-content"></div>
                <div id="carousel-pagination-dots" class="carousel-pagination"></div>
            </div>

            <!-- ALL COURSES SECTION -->
            <div id="all-courses" class="mb-12">
                <!-- Title and Filters on Same Line -->
                <div class="mb-6 pb-4 border-b border-gray-200 dark:border-gray-700">
                    <div class="flex flex-wrap gap-4 items-center justify-between mb-4">
                        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 dark:text-gray-200 flex-shrink-0">
                            ?? All Courses
                        </h2>

                        <!-- Search Bar -->
                        <div class="relative flex-shrink-0">
                            <input type="text" id="course-search" placeholder="Search courses..." class="pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm w-64">
                            <i class="fas fa-search text-gray-400 absolute left-3 top-1/2 -translate-y-1/2 text-sm"></i>
                        </div>

                        <!-- Instructor Filter -->
                        <div class="flex items-center space-x-2 flex-shrink-0">
                            <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Instructor:</label>
                            <input type="text" id="instructor-filter" placeholder="Filter by instructor..." class="px-3 py-1.5 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm bg-white dark:bg-gray-800 dark:text-gray-200 w-48">
                        </div>

                        <!-- Clear Filters Button -->
                        <button id="clear-filters-btn" class="px-4 py-1.5 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors text-sm font-medium flex-shrink-0">
                            Clear Filters
                        </button>
                    </div>

                    <!-- Category Filters -->
                    <div class="flex items-center space-x-3 overflow-x-auto">
                        <div class="text-lg font-semibold text-gray-800 dark:text-gray-200 flex-shrink-0">Explore:</div>
                        <div id="category-filter-buttons" class="flex space-x-3 flex-shrink-0">
                            <button data-filter="All" class="filter-btn active">All</button>
                            <button data-filter="Development" class="filter-btn">?? Development</button>
                            <button data-filter="Design" class="filter-btn">?? Design</button>
                            <button data-filter="Data Science" class="filter-btn">?? Data Science</button>
                            <button data-filter="Marketing" class="filter-btn">?? Marketing</button>
                            <button data-filter="AI & ML" class="filter-btn">?? AI & ML</button>
                            <button data-filter="Business" class="filter-btn">?? Business</button>
                        </div>
                    </div>
                </div>
            
            <div id="courses-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6 mb-12">
                <div id="loading-spinner" class="col-span-3 flex justify-center items-center h-64">
                    <div class="loading-container">
                        <div class="loader"></div>
                        <p class="loading-text">Loading courses...</p>
                    </div>
                </div>
            </div>
            </div>

            <!-- POPULAR COURSES SECTION -->
            <div class="mb-12">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl md:text-3xl font-bold text-gray-800 dark:text-gray-200">
                        ?? Popular Courses
                    </h2>
                    <a href="#all-courses" class="text-blue-600 hover:text-blue-700 font-medium text-sm md:text-base">
                        View All ?
                    </a>
                </div>
                <div id="popular-courses-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:gap-6">
                    <div class="col-span-full flex justify-center items-center h-64">
                        <div class="loading-container">
                            <div class="loader"></div>
                            <p class="loading-text">Loading popular courses...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TRENDING COURSES SECTION -->
            <div class="mb-12">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl md:text-3xl font-bold text-gray-800 dark:text-gray-200">
                        ?? Trending This Week
                    </h2>
                    <a href="#all-courses" class="text-blue-600 hover:text-blue-700 font-medium text-sm md:text-base">
                        View All ?
                    </a>
                </div>
                <div id="trending-courses-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:gap-6">
                    <div class="col-span-full flex justify-center items-center h-64">
                        <div class="loading-container">
                            <div class="loader"></div>
                            <p class="loading-text">Loading trending courses...</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 mb-6">Explore Topics</h2>
                <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                    <div class="category-gallery-item rounded-lg shadow-lg overflow-hidden" data-category="Development" style="background-image: url('https://images.unsplash.com/photo-1461749280684-dccba630e2f6?ixlib=rb-4.0.3&q=85&fm=jpg&crop=entropy&cs=srgb&w=400');">
                        <div class="absolute inset-0 bg-black/30 flex items-end p-3 z-10"><h3 class="text-xl font-bold text-white">Development</h3></div>
                    </div>
                    <div class="category-gallery-item rounded-lg shadow-lg overflow-hidden" data-category="Design" style="background-image: url('https://images.unsplash.com/photo-1581291518857-4e27b48ff24e?ixlib=rb-4.0.3&q=85&fm=jpg&crop=entropy&cs=srgb&w=400');">
                        <div class="absolute inset-0 bg-black/30 flex items-end p-3 z-10"><h3 class="text-xl font-bold text-white">Design</h3></div>
                    </div>
                    <div class="category-gallery-item rounded-lg shadow-lg overflow-hidden" data-category="Data Science" style="background-image: url('https://images.unsplash.com/photo-1551288049-bebda4e38f71?ixlib=rb-4.0.3&q=85&fm=jpg&crop=entropy&cs=srgb&w=400');">
                        <div class="absolute inset-0 bg-black/30 flex items-end p-3 z-10"><h3 class="text-xl font-bold text-white">Data Science</h3></div>
                    </div>
                    <div class="category-gallery-item rounded-lg shadow-lg overflow-hidden" data-category="Marketing" style="background-image: url('https://images.unsplash.com/photo-1460925895917-afdab827c52f?ixlib=rb-4.0.3&q=85&fm=jpg&crop=entropy&cs=srgb&w=400');">
                        <div class="absolute inset-0 bg-black/30 flex items-end p-3 z-10"><h3 class="text-xl font-bold text-white">Marketing</h3></div>
                    </div>
                    <div class="category-gallery-item rounded-lg shadow-lg overflow-hidden" data-category="AI & ML" style="background-image: url('https://res.cloudinary.com/dxqrmxll4/image/upload/v1758951586/Pastel_Purple_Pastel_Green_3D_Choice_Board_Education_Website_1_nqncb7.png');">
                        <div class="absolute inset-0 bg-black/30 flex items-end p-3 z-10"><h3 class="text-xl font-bold text-white">AI & ML</h3></div>
                    </div>
                    <div class="category-gallery-item rounded-lg shadow-lg overflow-hidden" data-category="Business" style="background-image: url('https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&q=85&fm=jpg&crop=entropy&cs=srgb&w=400');">
                        <div class="absolute inset-0 bg-black/30 flex items-end p-3 z-10"><h3 class="text-xl font-bold text-white">Business</h3></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="lesson-page" class="lesson-container hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"></div>
    </div>

    <!-- Certificate Completion Popup -->
    <div id="certificate-completion-popup" class="hidden fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-2xl w-full p-8 text-center animate-bounce-in">
            <div class="mb-6">
                <div class="mx-auto w-24 h-24 bg-gradient-to-r from-green-400 to-blue-500 rounded-full flex items-center justify-center animate-pulse">
                    <svg class="w-16 h-16 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                </div>
            </div>
            <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">?? Congratulations!</h2>
            <p class="text-xl text-gray-700 dark:text-gray-300 mb-2">You have successfully completed</p>
            <p id="cert-course-title" class="text-2xl font-bold text-blue-600 dark:text-blue-400 mb-4"></p>
            <p class="text-gray-600 dark:text-gray-400 mb-8">Your certificate has been generated and is ready to view!</p>
            <div class="flex gap-4 justify-center">
                <button id="view-my-certificate-btn" class="bg-gradient-to-r from-blue-600 to-blue-600 hover:from-blue-700 hover:to-blue-700 text-white font-bold py-3 px-8 rounded-lg transition shadow-lg">
                    <i class="fas fa-certificate mr-2"></i>View My Certificate
                </button>
                <button id="close-cert-popup" class="bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 font-medium py-3 px-8 rounded-lg transition">
                    Continue Learning
                </button>
            </div>
        </div>
    </div>

<%- include('../partials/footer') %>

<!-- Load utilities -->
<script src="/js/shared/common-utils.js"></script>
<script src="/js/shared/auth-utils.js"></script>
<script src="/js/shared/api-utils.js"></script>

<!-- Load page scripts -->
<script src="/js/pages/courses.js"></script>
<script src="/js/pages/courses-lesson.js"></script>
</body>
</html>
